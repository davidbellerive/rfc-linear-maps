<div class="mapwrap" style="overflow-x:auto; max-width:100%; touch-action:none;">
  <img
    src="https://raw.githubusercontent.com/davidbellerive/linear-maps/main/rfc-maps/Toronto%20Transit%20Commission/Line%202%20%E2%80%93%20Bloor%E2%80%93Danforth%201980.svg"
    alt="TTC Line 2 — Bloor–Danforth (1980)"
    style="display:block; width:1100px; max-width:none; height:auto;"
    loading="lazy"
    decoding="async">
</div>

<div class="mapcontrols" style="margin-top:8px; display:flex; gap:8px;">
  <button type="button" data-dir="-1">◀</button>
  <button type="button" data-dir="1">▶</button>
</div>

<script>
(function(){
  function initPair(wrap, controls){
    if (!wrap || !controls) return;

    function step(){ return Math.round(wrap.clientWidth * 0.7); }
    function update(){
      controls.style.display = (wrap.scrollWidth > wrap.clientWidth + 2) ? 'flex' : 'none';
    }

    controls.addEventListener('click', function(e){
      var dir = e.target && e.target.dataset ? e.target.dataset.dir : null;
      if (!dir) return;
      wrap.scrollBy({ left: parseInt(dir,10) * step(), behavior: 'smooth' });
    });

    var img = wrap.querySelector('img');
    if (img) img.addEventListener('load', update);

    window.addEventListener('resize', update);
    if ('ResizeObserver' in window) new ResizeObserver(update).observe(wrap);

    wrap.addEventListener('touchmove', function(e){ e.preventDefault(); }, { passive:false });

    update();
  }

  var wraps = document.querySelectorAll('.mapwrap');
  wraps.forEach(function(wrap){
    // assumes controls is the next .mapcontrols sibling
    var controls = wrap.nextElementSibling;
    if (!controls || !controls.classList.contains('mapcontrols')) return;
    initPair(wrap, controls);
  });
})();
</script>
